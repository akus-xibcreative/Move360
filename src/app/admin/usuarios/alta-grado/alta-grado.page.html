<div class="alta-grado-container">

    <div class="header-actions">
      <ion-text color="dark">
        <h2 class="page-title">Alta de Grado</h2>
      </ion-text>

      <div class="actions-row">
        <ion-searchbar
        placeholder="Buscar por Clave"
        debounce="300"
        class="custom-search-bar"
        (ionInput)="filterGrades($event)"
        ></ion-searchbar>

      <ion-button
      (click)="changeToViewState()"
      fill="solid"
      class="custom-button btn-view"
      [disabled]="uiState === 'view'"
      >
      Ver
    </ion-button>

    <ion-button
    (click)="changeToNewState()"
    fill="solid"
    class="custom-button btn-new"
    [disabled]="uiState === 'new'"
    >
          Nuevo
        </ion-button>
      </div>
    </div>

    <ion-card class="data-card">
      <ion-card-content class="data-content-area">

        <div *ngIf="uiState === 'view'" class="table-container">

          <div class="table-header">
            <div class="header-cell">Clave</div>
            <div class="header-cell">Descripción</div>
            <div class="header-cell seq-cell">Secuencia</div>
          </div>

          <div class="table-row" *ngFor="let grade of filteredGrades">
            <div class="data-cell">{{ grade.id }}</div>
            <div class="data-cell">{{ grade.desc }}</div>
            <div class="data-cell seq-cell">{{ grade.seq }}</div>
          </div>

          <div *ngIf="filteredGrades.length === 0" class="no-results">
            <ion-text color="medium">
              <p>No se encontraron grados que coincidan con la búsqueda.</p>
            </ion-text>
          </div>
        </div>

        <div *ngIf="uiState === 'new'" class="form-container">

          <div class="table-header">
            <div class="header-cell">Clave</div>
            <div class="header-cell">Descripción</div>
            <div class="header-cell seq-cell">Secuencia</div>
          </div>

          <div class="table-row input-row">
            <div class="data-cell input-cell">
              <input type="text" [(ngModel)]="newGrade.id" placeholder="Ingrese clave" class="cell-input" min="1"/>
            </div>
            <div class="data-cell input-cell">
              <input type="text" [(ngModel)]="newGrade.desc" placeholder="Ingrese descripción" class="cell-input" />
            </div>
            <div class="data-cell input-cell seq-cell">
              <input type="text" inputmode="numeric" [(ngModel)]="newGrade.seq" (input)="onlyNumbers($event)" placeholder="Ingrese secuencia" class="cell-input"/>
            </div>
          </div>

          <div class="bottom-actions-row">
            <ion-button
            (click)="changeToViewState()"
            fill="outline"
            color="medium"
            class="action-button cancel-button"
            >
            Cancelar
          </ion-button>
          <ion-button
          (click)="confirmGrade()"
          fill="solid"
          color="primary"
          class="custom-button confirm-button"
          >
          Confirmar
        </ion-button>
      </div>
    </div>

    <!-- Skeleton Loading -->
    <div *ngIf="uiState === 'skeleton'" class="table-container">
      <div class="table-header">
        <div class="header-cell">Clave</div>
        <div class="header-cell">Descripción</div>
        <div class="header-cell seq-cell">Secuencia</div>
      </div>

      <div class="table-row" *ngFor="let i of [1, 2, 3, 4, 5]">
        <div class="data-cell"><ion-skeleton-text animated style="width: 80%"></ion-skeleton-text></div>
        <div class="data-cell"><ion-skeleton-text animated style="width: 90%"></ion-skeleton-text></div>
        <div class="data-cell seq-cell"><ion-skeleton-text animated style="width: 50%"></ion-skeleton-text></div>
      </div>
    </div>

    <!-- Estado Empty -->
    <div *ngIf="uiState === 'empty'" class="empty-state">
      <ion-icon name="search-outline" size="large"></ion-icon>
      <ion-text color="medium">
        <h3>Sin Resultados</h3>
        <p>No se encontraron grados que coincidan con su búsqueda.</p>
      </ion-text>
    </div>

    <!-- Estado Error -->
    <div *ngIf="uiState === 'error'" class="error-state">
      <ion-icon name="close-circle-outline" size="large"></ion-icon>
      <ion-text color="danger">
        <h3>Error de Conexión</h3>
        <p>Ocurrió un problema al cargar los datos. Inténtelo de nuevo más tarde.</p>
      </ion-text>
    </div>

  </ion-card-content>
</ion-card>
</div>
